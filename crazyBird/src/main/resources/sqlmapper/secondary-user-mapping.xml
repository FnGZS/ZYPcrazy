<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.crazyBird.dao.secondary.SecondaryUserDao">
<resultMap id="sellResult" type="com.crazyBird.dao.secondary.dataobject.SellSecondaryDTO" >
    <result column="id" property="id" jdbcType="BIGINT" />
    <result column="user_id" property="userId" jdbcType="BIGINT" />
    <result column="views" property="views" jdbcType="INTEGER" />
    <result column="goods_num" property="goodsNum" jdbcType="INTEGER" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="headimgurl" property="headImgUrl" jdbcType="VARCHAR" />
    <result column="goods_title" property="goodsTitle" jdbcType="VARCHAR" />
    <result column="goods_content" property="goodsContent" jdbcType="VARCHAR" />
    <result column="goods_img" property="goodsImag" jdbcType="VARCHAR" />
    <result column="postion" property="postion" jdbcType="VARCHAR" />
    <result column="goods_type" property="goodsType" jdbcType="VARCHAR" />
    <result column="goods_way" property="goodsWay" jdbcType="VARCHAR" />
    <result column="trading_way" property="tradingWay" jdbcType="VARCHAR" />
    <result column="goods_price" property="price" jdbcType="DECIMAL" />
    <result column="gmt_created" property="gmtCreated" jdbcType="TIMESTAMP" />
</resultMap>
<select id="getSellSecondaryCountByUser" resultType="java.lang.Integer" parameterType="java.lang.Long">
  	select 
	count(1)
  	from secondary_goods where user_id = {userId,jdbcType=BIGINT}
  </select>
  <select id="getSellSecondaryByUser" resultMap="sellResult" parameterType="java.lang.Long">
  select sg.id ,u.user_name,u.headimgurl,sg.user_id,sg.goods_num,sg.goods_title,sg.goods_content,sg.goods_img,sg.goods_price,sg.postion,sg.views,sw.field as goods_way ,stw.field as trading_way ,st.field as goods_type, sg.gmt_created 
	from secondary_goods as sg 
	LEFT JOIN secondary_way as sw on sw.id=sg.goods_way 
	LEFT JOIN secondary_type as st on st.id=sg.goods_type
	LEFT JOIN secondary_trading_way as stw on stw.id = sg.trading_way LEFT JOIN `user` as u ON u.school_num=sg.user_id where sg.`status`=1 
	where sg.user_id = {userId,jdbcType=BIGINT}
	order by gmt_created desc
	limit #{startPos,jdbcType=INTEGER},#{pageSize,jdbcType=INTEGER}
  </select>
</mapper>